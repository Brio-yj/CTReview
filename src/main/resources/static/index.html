<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>CTReview – 스마트 복습</title>
    <link rel="stylesheet" href="/assets/app.css" />
    <link rel="stylesheet" href="/assets/app.light.css" />
    <style>
        :root{
            --h-top: 500px;
            --h-mid-1: 120px;
            --h-mid-2: 510px;
        }
        .container{
            display:grid;
            grid-template-columns: 1.5fr 1fr;
            grid-template-rows: var(--h-top) var(--h-mid-1) var(--h-mid-2) auto;
            grid-template-areas:
                "today add"
                "search quick"
                "search filter"
                "dash dash";
            gap:16px;
            padding:0 20px 24px 20px;
            align-items:stretch;
        }
        .q1-today{ grid-area: today; }
        .q1-search-result{ grid-area: search; }
        .q2-add{ grid-area: add; }
        .q2-quick{ grid-area: quick; }
        .q2-filter{ grid-area: filter; }
        .q34-dashboard{ grid-area: dash; }
    </style>
</head>
<body>
<header>
    <div class="header-row">
        <section class="card header-left">
            <div class="card-body">
                <h1>CTReview – 스마트 복습</h1>
                <div class="sub">Solve 전용 졸업, Fail 자동 연장(마지막 간격×2), 자동 이월, 검색/통계/히트맵 지원</div>
                <div id="auth-area" class="row" style="margin-top:8px; gap:8px;">
                    <span id="auth-user"></span>
                    <button class="btn" id="btn-theme"><span id="theme-icon">🌙</span> <span id="theme-label">Dark</span></button>
                    <button class="btn" id="btn-login">로그인</button>
                    <button class="btn" id="btn-register">회원가입</button>
                    <button class="btn" id="btn-logout" style="display:none;">로그아웃</button>
                </div>
            </div>
        </section>
        <section class="card heatmap-card header-right">
            <div class="body">
                <nav class="heatmap-nav">
                    <button class="btn" id="heatmap-prev">‹</button>
                    <h3 id="heatmap-month"></h3>
                    <button class="btn" id="heatmap-next">›</button>
                </nav>
                <div id="heatmap-day-header" class="heatmap-day-header"></div>
                <div id="heatmap-grid" class="heatmap-grid" aria-label="monthly-heatmap"></div>

                <div class="heatmap-legend">
                    <span>Less</span>
                    <span class="swatch" style="background-color:var(--heat-0)"></span>
                    <span class="swatch" style="background-color:var(--heat-1)"></span>
                    <span class="swatch" style="background-color:var(--heat-2)"></span>
                    <span class="swatch" style="background-color:var(--heat-3)"></span>
                    <span class="swatch" style="background-color:var(--heat-4)"></span>
                    <span>More</span>
                </div>
            </div>
        </section>
    </div>
</header>
<div class="container">
    <section class="card card--clip q2-add">
        <h2>문제 추가</h2>
        <div class="body stack">
            <div>
                <label>카테고리 (선택)</label>
                <select id="p-category">
                    <option value="">선택 안 함</option>
                    <option value="BAEKJOON">백준</option>
                    <option value="PROGRAMMERS">프로그래머스</option>
                </select>
            </div>
            <div>
                <label>문제 번호 (선택)</label>
                <input id="p-number" type="number" placeholder="없으면 비워두세요" />
            </div>
            <div>
                <label>문제 이름</label>
                <input id="p-name" type="text" placeholder="예) 부등호 / 문자열 압축" />
            </div>
            <div>
                <label>난이도</label>
                <select id="p-difficulty">
                    <option value="HIGH">상</option>
                    <option value="MEDIUM">중</option>
                    <option value="LOW">하</option>
                </select>
            </div>
            <button class="btn" id="btn-add">추가하기</button>
            <div class="footer-note">추가 시 정책에 맞춰 첫 복습일이 자동 설정됩니다.</div>
        </div>
    </section>

    <section class="card card--clip q2-quick">
        <h2>예습</h2>
        <div class="body">
            <input id="quick-name" type="text" placeholder="문제 이름으로 Solve/Fail">
            <button class="btn btn-ok" id="quick-solve">Solve</button>
            <button class="btn btn-bad" id="quick-fail">Fail</button>
        </div>
    </section>

    <section class="card card--clip q2-filter">
        <h2>검색 / 필터</h2>
        <div class="body stack">
            <div class="grid-2">
                <div>
                    <label>번호</label>
                    <input id="s-number" type="number" placeholder="정확 일치" />
                </div>
                <div>
                    <label>난이도</label>
                    <select id="s-difficulty">
                        <option value="">전체</option>
                        <option value="HIGH">상</option>
                        <option value="MEDIUM">중</option>
                        <option value="LOW">하</option>
                    </select>
                </div>
            </div>
            <div>
                <label>이름(포함 검색)</label>
                <input id="s-q" type="text" placeholder="문제명 일부" />
            </div>
            <div class="grid-2">
                <div>
                    <label>From</label>
                    <input id="s-from" type="date" placeholder="YYYY-MM-DD" />
                </div>
                <div>
                    <label>To</label>
                    <input id="s-to" type="date" placeholder="YYYY-MM-DD" />
                </div>
            </div>
            <div>
                <label>정렬</label>
                <select id="s-sort">
                    <option value="dateAsc">날짜 오름차순</option>
                    <option value="dateDesc">날짜 내림차순</option>
                    <option value="stepDesc">복습단계 내림차순</option>
                    <option value="stepAsc">복습단계 오름차순</option>
                </select>
            </div>
            <button class="btn" id="btn-search">검색</button>
        </div>
    </section>

    <section class="card card--fixed q1-today">
        <h2>오늘 복습</h2>
        <div class="body">
            <div class="table-wrap" id="wrap-today">
                <table class="table table-today">
                    <colgroup>
                        <col class="col-cat"     style="width: 110px;">
                        <col class="col-num"     style="width: 90px;">
                        <col class="col-name">                 <!-- 남는 폭 전부 사용 -->
                        <col class="col-diff"    style="width: 88px;">
                        <col class="col-step"    style="width: 100px;">
                        <col class="col-actions" style="width: 160px;">
                    </colgroup>
                    <thead>
                    <tr>
                        <th>카테고리</th>
                        <th>번호</th>
                        <th>이름</th>
                        <th>난이도</th>
                        <th>복습단계</th>
                        <th>결과</th>
                    </tr>
                    </thead>
                    <tbody id="tbl-today"></tbody>
                </table>
            </div>
        </div>
    </section>

    <section class="card card--fixed q1-search-result">
        <h2>검색 결과</h2>
        <div class="body">
            <div class="table-wrap" id="wrap-search">
                <table class="table table-search">
                    <colgroup>
                        <col class="col-name">                 <!-- 남는 폭 전부 사용 -->
                        <col class="col-diff"    style="width: 88px;">
                        <col class="col-date"    style="width: 132px;">
                        <col class="col-step"    style="width: 100px;">
                        <col class="col-grad"    style="width: 90px;">
                        <col class="col-delete"  style="width: 90px;">
                    </colgroup>
                    <thead>
                    <tr>
                        <th>이름</th>
                        <th>난이도</th>
                        <th>복습날짜</th>
                        <th>복습단계</th>
                        <th>졸업</th>
                        <th>삭제</th>
                    </tr>
                    </thead>
                    <tbody id="tbl-search"></tbody>
                </table>
            </div>
        </div>
    </section>

    <section class="card q34-dashboard">
        <h2>대시보드</h2>
        <div class="body">
            <div class="row" style="justify-content: space-between; margin-bottom: 12px;">
                <div id="streak" class="pill warn">streak …</div>
                <button class="btn" id="btn-refresh-dashboard">대시보드 새로고침</button>
            </div>
            <div class="grid-3" style="margin-bottom:12px;">
                <div class="card" style="padding:12px;">
                    <div class="sub">복습단계 분포</div>
                    <div id="level-dist" style="font-size:14px; margin-top:8px; display:grid; gap:6px;"></div>
                </div>
                <div class="card" style="padding:12px;">
                    <div class="sub">오늘 날짜</div>
                    <div id="today-text" style="font-size:14px; margin-top:8px;"></div>
                </div>
                <div class="card" style="padding:12px;">
                    <div class="sub">졸업 합계(난이도별)</div>
                    <div id="grad-total" style="font-size:14px; margin-top:8px;"></div>
                </div>
            </div>
            <div class="charts">
                <div>
                    <div class="sub" style="margin-bottom:6px;">일일 처리량(최근 30일)</div>
                    <canvas id="chart-daily" width="640" height="260"></canvas>
                </div>

                <div>
                    <div class="sub" style="margin-bottom:6px;">졸업한 문제들</div>
                    <div class="grad-list-container" id="grad-list">
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<template id="row-actions">
    <div class="row" style="gap: 4px;">
        <button class="btn btn-ok" data-act="solve">Solve</button>
        <button class="btn btn-bad" data-act="fail">Fail</button>
        <button class="btn" data-act="delete">Delete</button>
        <button class="btn" data-act="graduate">졸업</button>
    </div>
</template>

<script src="/assets/app.js"></script>
</body>
</html>